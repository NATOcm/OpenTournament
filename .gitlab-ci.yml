variables:
  GIT_STRATEGY: none        # we disable fetch, clone or checkout for every job
  GIT_CHECKOUT: "false"     # as we only want to checkout and fetch in the preperation stage

stages:
  - preperations
  - package

preperations:
  stage: preperations
  variables:
    GIT_STRATEGY: fetch
    GIT_CHECKOUT: "true"
  script:
    - call "C:\BuildScripts\StartBuild.bat"

package:
  stage: package
  only:
    - web                 # only archive when started through the web interface
    - schedules           # only archive when started at a specific schedule -TEST-
  script:
    - echo "Adding build to the artifacts"
    - Start-Process "cmd.exe" "/c C:\BuildScripts\Archive.bat"
  artifacts:
    paths:
      - PROJECT_NAME.zip
    expire_in: 5 days